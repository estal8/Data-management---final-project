---
title: "Socio-economic determinants of crime in U.S. states"
author: "Paula de Miguel Sánchez & Esther Allevi"
format:
  pdf:
    toc: true
    number-sections: true
execute:
  echo: false
  warning: false
---

## Research question

Our project studies the socio-economic and demographic determinants of crime in the United States at the state level. More precisely, we ask whether economic opportunities and social inequalities are correlated with different types of crime (violent and property crime) across states and over time.

Crime in the United States exhibits substantial variation across states and over time, and understanding the socio-economic factors that contribute to these differences remains a central question in both economics and public policy. Our project aims to investigate how economic conditions, demographic structure, inequality, public spending, and police behaviour correlate with violent and property crime at the state–year level. The objective is not to establish strict causal relationships—an ambitious task given the observational nature of the data—but rather to document robust associations and explore whether crime levels systematically co-evolve with structural socio-economic indicators.

A first motivation for this research question is the long-standing hypothesis that economic opportunity and crime are linked. Periods of slow economic growth and labour market stress may increase incentives for certain types of offences, particularly property crime. To examine this mechanism, we combine the crime data from the CORGIS/FBI series with annual state GDP from the Bureau of Economic Analysis. GDP provides a measure of overall economic activity and allows us to test whether states experiencing strong or weak economic performance also display different crime patterns.

Income inequality is another potential determinant of criminal activity. The World Inequality Database (WID) provides rich information on income shares and fiscal aggregates at the top and bottom of the distribution. High inequality may generate both economic stress and social fragmentation, potentially amplifying incentives for crime or reducing the perceived legitimacy of institutions. By merging the WID data with the crime series, we can evaluate whether states with higher income concentration or lower fiscal income shares among the majority of the population exhibit systematically different violent or property crime rates.

Migration flows constitute a third dimension of interest. Public debate often assumes—sometimes incorrectly—that immigration influences crime rates. The DHS immigration data enable us to incorporate yearly state-level measures of lawful permanent residents, nonimmigrants, asylees, and refugees. Our goal is not to test politically charged claims, but to empirically examine whether changes in migration patterns are associated with changes in state crime trends once we control for other socio-economic conditions.

In addition, we incorporate information on public expenditure and food assistance (from the Census and USDA Food Environment Atlas), which may proxy for the strength of social safety nets and local investment in welfare-related programmes. States with stronger social services may provide better support for vulnerable populations, potentially mitigating some of the socio-economic pressures that contribute to crime. Including these variables allows us to explore such channels empirically.

Finally, we integrate data on police shootings from the Washington Post database. While this dataset does not measure police activity directly, fatal shootings can serve as a proxy for law-enforcement intensity or tension between police and residents. Investigating whether states with higher levels of fatal shootings also differ in crime trends contributes to a broader understanding of institutional and behavioural dimensions of crime.

How do economic conditions, income inequality, immigration flows, public spending, and police activity correlate with violent and property crime across U.S. states?

## Brief dataset description

We build our panel from nine sources : 

- Crime rates (FBI/CORGIS, 1960–2019) distinguishing violent and property offences, and state population ;

- Income inequality (WID, 1960–2018) providing top income shares by state;

- GDP and consumption per capita (BEA Regional Accounts, 1998–2023);

- Unemployment rate (BLS, 1976-2025);

- Prison population (The Sentencing Project, 1980–2022);

- Poverty rates (Census Bureau, 1980–2023);

- Beer consumption per capita (NIAAA, 1970–2022);

- Immigration flows (DHS, 2013–2023) covering legal residents, refugees and asylees;

- Police shootings (Washington Post, 2015–2024);

- Public spending (Census Bureau, 2017–2023) on education, welfare, health, corrections and police;

- Food assistance participation (USDA Food Environment Atlas, 2012-2023).

Full descriptions are provided in the data cleaning document (Phase 2).

## Data analysis

Our empirical analysis is divided into two parts, reflecting the heterogeneous temporal coverage of our sources. 

The crime, inequality, GDP, consumption, unemployment, prison population, poverty, and alcohol series provide consistent state-year observations between 1998-2018. It allows us to examine the structural relationships between economic conditions and crime using fixed effects panel regressions. 

In contrast, immigration flows (2013–2018), police shootings (2015–2018), public spending (2017–2018) and food access (2012-2023) are only available for recent years. Rather than discarding these valuable contemporary indicators, we adopt a two-stage approach: we first exploit the full historical depth of our panel to study structural relationships between economic conditions and crime, then narrow the window to a shorter period to incorporate additional explanatory factors in a richer, shorter-term analysis.

### **Long-run analysis (1998–2018)**

#### Descriptive analysis

```{r}
#| message: false

library(ggplot2)
library(plm)
library(dplyr)
library(tidyverse)
library(here)
library(vroom)
library(modelsummary)
library(kableExtra)
```

```{r}
#| message: false

here::i_am("Data-management---final-project.Rproj")
panel_full <- vroom(here("DATA_panel_full.csv"))
panel_full_final <- vroom(here("DATA_panel_full_final.csv"))
```

##### National long-run trends in crime (1960-2018)

To establish a benchmark for the subsequent analysis, we first document the long-run evolution of violent and property crime across U.S. states. Figure 1 displays the average crime rate across states together with the 10th–90th percentile range, providing a synthetic view of both aggregate dynamics and cross-state heterogeneity.

```{r}
panel_long <- panel_full |>
  filter(Year <= 2018)
crime_distribution <- panel_long |>
  group_by(Year) |>
  summarise(
    violent_mean = mean(Data.Rates.Violent.All, na.rm = TRUE),
    violent_p10  = quantile(Data.Rates.Violent.All, 0.10, na.rm = TRUE),
    violent_p90  = quantile(Data.Rates.Violent.All, 0.90, na.rm = TRUE),

    property_mean = mean(Data.Rates.Property.All, na.rm = TRUE),
    property_p10  = quantile(Data.Rates.Property.All, 0.10, na.rm = TRUE),
    property_p90  = quantile(Data.Rates.Property.All, 0.90, na.rm = TRUE),
    .groups = "drop"
  ) |>
  pivot_longer(
    cols = -Year,
    names_to = c("type", "stat"),
    names_pattern = "(violent|property)_(mean|p10|p90)",
    values_to = "value"
  ) |>
  mutate(
    type = recode(type,
                  violent = "Violent crime",
                  property = "Property crime")
  ) |>
  pivot_wider(names_from = stat, values_from = value)
```

```{r}
#| fig-cap: "National crime trends and cross-state dispersion (mean and 10th–90th percentiles, 1960–2018)"
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_distribution, aes(x = Year)) +
  geom_ribbon(aes(ymin = p10, ymax = p90), alpha = 0.25) +
  geom_line(aes(y = mean), linewidth = 0.9) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    title = "Crime trends across U.S. states (1960–2018)",
    x = "Year",
    y = "Crimes per 100,000 inhabitants"
  ) +
  theme_minimal()
```

Both crime categories exhibit a pronounced common time profile, with a strong increase from the 1960s to the late 1980s or early 1990s, followed by a sustained decline.

Despite these shared national trends, cross-state heterogeneity remains large throughout the entire period, as illustrated by the wide percentile bands.

Property crime displays a particularly strong rise and fall, whereas violent crime peaks later and declines more gradually, suggesting distinct underlying mechanisms. The persistence of substantial dispersion across states indicates that national trends alone cannot account for observed crime dynamics and highlights the relevance of state-specific factors. These descriptive findings motivate the use of panel models with both state and time fixed effects in the subsequent analysis.


##### Evolution of violent crime and property crime in the US per states.

```{r}
crime_by_state <- panel_full |>
  select(State, Year, Data.Rates.Violent.All, Data.Rates.Property.All) |>
  pivot_longer(
    cols = c(Data.Rates.Violent.All, Data.Rates.Property.All),
    names_to = "type",
    values_to = "rate"
  ) |>
  mutate(
    type = case_when(
      type == "Data.Rates.Violent.All" ~ "Violent crime",
      type == "Data.Rates.Property.All" ~ "Property crime"
    )
  )
```

```{r}
#| fig-cap: "Violent and property crime rates by U.S. state"
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_by_state, aes(x = Year, y = rate, colour = State)) +
  geom_line(linewidth = 0.7) +
  facet_wrap(~type, scales = "free_y") +
  labs(
    title = "Crime rates by U.S. state (1960–2018)",
    x = "Year",
    y = "Crimes per 100,000 inhabitants"
  ) +
  theme_minimal()
```

##### Evolution of violent crime and property crime among high-crime states

```{r}
top_states <- panel_full |>
  filter(Year <= 2018) |>
  group_by(State) |>
  summarise(mean_violent = mean(Data.Rates.Violent.All, na.rm = TRUE)) |>
  arrange(desc(mean_violent)) |>
  slice_head(n = 8) |>
  pull(State)

crime_by_state_top <- panel_full |>
  filter(Year <= 2018, State %in% top_states) |>
  select(State, Year, Data.Rates.Violent.All, Data.Rates.Property.All) |>
  pivot_longer(
    cols = c(Data.Rates.Violent.All, Data.Rates.Property.All),
    names_to = "type",
    values_to = "rate"
  ) |>
  mutate(
    type = case_when(
      type == "Data.Rates.Violent.All" ~ "Violent crime",
      type == "Data.Rates.Property.All" ~ "Property crime"
    )
  )
```

```{r}
#| fig-cap: "Violent and property crime rates in the eight highest-crime U.S. states (1960–2018)"
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_by_state_top, aes(x = Year, y = rate, colour = State)) +
  geom_line(linewidth = 0.7) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    title = "Crime rates in the eight highest-crime states (1960–2018)",
    x = "Year",
    y = "Crimes per 100,000 inhabitants",
    colour = "State"
  ) +
  theme_minimal()
```

##### Descriptive co-movement with economic structure

```{r}
#Before imposing a linear model, do crime rates co-move with economic conditions and inequality in the raw data, once we pool state–year observations?

crime_gdp <- panel_long |>
  filter(!is.na(gdp)) |>
  transmute(
    Year,
    log_gdp = log(gdp),
    property = Data.Rates.Property.All,
    violent  = Data.Rates.Violent.All
  ) |>
  pivot_longer(
    cols = c(property, violent),
    names_to = "type",
    values_to = "crime"
  ) |>
  mutate(
    type = recode(type,
      property = "Property crime",
      violent  = "Violent crime"
    )
  )
```

```{r}
#| fig-cap: "Raw co-movement between crime and GDP (pooled state–year observations)"
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_gdp, aes(x = log_gdp, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Log state GDP",
    y = "Crimes per 100,000 inhabitants"
  ) +
  theme_minimal()
```

Property crime: The pooled scatter plot reveals a clear non-linear relationship between property crime and state GDP. At low to intermediate levels of GDP, property crime rates tend to increase, before declining for higher levels of economic activity. The downward-sloping segment at higher GDP levels suggests that economically stronger states tend to experience lower property crime rates, consistent with the hypothesis that improved economic opportunities reduce incentives for financially motivated offences. The dispersion of observations around the fitted curve remains substantial, indicating that GDP alone cannot account for cross-state differences in property crime.

Violent crime: In contrast, the relationship between violent crime and GDP is markedly weaker. While violent crime rates increase sharply at low GDP levels, the association flattens and becomes less systematic as GDP rises. At higher levels of economic activity, violent crime exhibits no clear monotonic decline. This pattern suggests that violent crime is less directly tied to economic performance than property crime and is likely driven by additional social, institutional, and demographic factors.

```{r}
crime_ineq <- panel_long |>
  filter(!is.na(share_pretax_income_p90p100)) |>
  transmute(
    Year,
    inequality = share_pretax_income_p90p100,
    property = Data.Rates.Property.All,
    violent  = Data.Rates.Violent.All
  ) |>
  pivot_longer(
    cols = c(property, violent),
    names_to = "type",
    values_to = "crime"
  ) |>
  mutate(
    type = recode(type,
      property = "Property crime",
      violent  = "Violent crime"
    )
  )
```

```{r}
#| fig-cap: "Raw co-movement between crime and income inequality (pooled state–year observations)"
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_ineq, aes(x = inequality, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Top 10% pre-tax income share",
    y = "Crimes per 100,000 inhabitants"
  ) +
  theme_minimal()
```

Property crime: The relationship between property crime and income inequality is non-linear and noisy. Property crime rates are highest at intermediate levels of inequality and decline at the upper end of the income share distribution. This inverted-U pattern suggests that inequality may matter for property crime, but its effect is neither simple nor monotonic. The wide dispersion of observations highlights the importance of unobserved state-specific characteristics.

Violent crime: It displays a more pronounced association with inequality. Crime rates increase strongly as the top income share rises from low to intermediate levels, before declining slightly at very high levels of inequality. This pattern is consistent with theories linking violent crime to social fragmentation, relative deprivation, and institutional stress, rather than purely economic incentives.

#### Regression analysis

Taken together, the descriptive evidence suggests that crime rates in U.S. states co-evolve with economic conditions and income inequality, but that these relationships are heterogeneous and potentially confounded by persistent state-specific characteristics and common national shocks. To account for these factors and move beyond raw correlations, we now estimate panel regressions with state and year fixed effects, which exploit within-state variation over time while controlling for unobserved heterogeneity.

##### Hypotheses

We test the following hypotheses:

- **H1 (opportunity cost)** : Higher GDP and lower unemployment are associated with lower crime rates, particularly for property crime.
- **H2 (inequality)** : Greater income concentration at the top of the distribution is associated with higher crime rates.
- **H3 (deterrence)** : Larger prison populations are associated with lower crime rates because of incapacitation of criminals.
- **H4 (alcohol as a criminogenic factor)** : Higher alcohol consumption is associated with higher violent crime rates.
- **H5 (crime persistence)** : Crime rates exhibit temporal inertia, i.e. past crime is a strong predictor of current crime (it encourages or discourages entry, it owerwhelms law enforcers…).

We estimate different models for property and violent crime, as property crime is more directly linked to economic incentives (Becker, 1968), while violent crime may be more linked to specific social factors.

##### Fixed effects 

```{r}
panel_reg <- panel_full_final |>
  filter(Year >= 1998 & Year <= 2018) |>
  filter(State != "District of Columbia") |>
  filter(!is.na(gdp), !is.na(Data.Rates.Violent.All), 
         !is.na(Data.Rates.Property.All), !is.na(share_pretax_income_p90p100), !is.na(Consumption), !is.na(unemployment_rate), !is.na(Data.Population)) |>
  mutate(log_gdp = log(gdp), 
         log_pop = log(Data.Population))
```

First we test for the model that best suits our data.


**Faire une annonce de plan résumant tous les modèles**

Our baseline model looks like this : 

$$Crime_{it} = \alpha_i + \beta_1 \log(GDP_{it}) + \beta_2 \cdot Inequality_{it} + \beta_3 \cdot Unemployment_{it} + \beta_4 \cdot Prison_{it} + \gamma_1 \cdot Beer_{it} + \gamma_2 \cdot \log(Pop_{it}) + \epsilon_{it}$$
where $\alpha_i$ denotes state fixed effects. The coefficients are identified from within-state variation over time. 

We measure inequalities by using the share of pre-tax income accruing to the top 10% of the distribution, as provided by the World Inequality Database. A higher share indicates greater income concentration at the top, which could be associated with increased social tension and crime rates (Fajnzylber, Lederman, and Loayza, 2002).

```{r}
model_property_1 <- plm(
  Data.Rates.Property.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)

summary(model_property_1)
```

```{r}
model_violent_1 <- plm(
  Data.Rates.Violent.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)

summary(model_violent_1)
```

The panel regression results reveal a contrast between the two types of crime, that we had initially planned.

For property crime, our variables explains approximately 73% of the within-state variation (R² = 0.73), which is consistent with economic theories on crime, suggesting for instance that property offences are motivated by financial need (Becker, 1968), that unemployment and alcohol consumption also increase crime rates (retrouver les articles lus là-dessus).

As for violent crime, our variables fails to significantly predict violent crime rates (R² = 0.25), indicating that violent offences are driven by factors beyond economic conditions alone.



Model 2 : we replace $log(GDP)$ by $Consumption$ to test another measure of economic conditions.

$$Crime_{it} = \alpha_i + \beta_1 \log(Consumption_{it}) + \beta_2 \cdot Inequality_{it} + \beta_3 \cdot Unemployment_{it} + \beta_4 \cdot Prison_{it} + \gamma_1 \cdot Beer_{it} + \gamma_2 \cdot \log(Pop_{it}) + \epsilon_{it}$$

```{r}
model_property_2 <- plm(
  Data.Rates.Property.All ~ Consumption +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)

summary(model_property_2)
```

```{r}
model_violent_1 <- plm(
  Data.Rates.Violent.All ~ Consumption +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)

summary(model_violent_1)
```



Model 3 :  we replace $Unemployment$ by $Poverty rate$ to test another measure of economic difficulties

$$Crime_{it} = \alpha_i + \beta_1 \log(GDP_{it}) + \beta_2 \cdot Inequality_{it} + \beta_3 \cdot Poverty_{it} + \beta_4 \cdot Prison_{it} + \gamma_1 \cdot Beer_{it} + \gamma_2 \cdot \log(Pop_{it}) + \epsilon_{it}$$



To look into crime persistence (i.e., the tendency of high-crime states to remain high-crime), we estimate a dynamic panel model including lagged crime rates as an explanatory variable (Model 4).

$$Crime_{it} = \alpha_i + \theta \cdot Crime_{i,t-1} + \beta_1 \log(GDP_{it}) + \beta_2 \cdot Inequality_{it} + \beta_3 \cdot Unemployment_{it} + \beta_4 \cdot Prison_{it} + \gamma_1 \cdot Beer_{it} + \gamma_2 \cdot \log(Pop_{it}) + \epsilon_{it}$$

```{r}
panel_reg <- panel_reg |>
  group_by(State) |>
  arrange(Year) |>
  mutate(crime_lag = lag(Data.Rates.Property.All)) |>
  ungroup() |>
  filter(!is.na(crime_lag), log_gdp > 0)

model_property_4 <- plm(
  Data.Rates.Property.All ~ crime_lag + 
    log_gdp + 
    share_pretax_income_p90p100 +
    unemployment_rate +
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg |> filter(!is.na(crime_lag)),
  index = c("State", "Year"),
  model = "within"
)

summary(model_property_4)
```

The model explains 91,7% ($R^2 = 0.9177$) of the variation in crime rates within states over time. 

We add year fixed effects ($\delta_t$) to control for national trends (e.g., federal policies, economic cycles) that affect all states simultaneously.

$$Crime_{it} = \alpha_i + \delta_t + \theta \cdot Crime_{i,t-1} + \beta_1 \log(GDP_{it}) + \beta_2 \cdot Inequality_{it} + \beta_3 \cdot Unemployment_{it} + \beta_4 \cdot Prison_{it} + \gamma_1 \cdot Beer_{it} + \gamma_2 \cdot \log(Pop_{it}) + \epsilon_{it}$$

```{r}
# Property
model_property_5 <- plm(
  Data.Rates.Property.All ~ crime_lag +
    log_gdp + # or consumption
    share_pretax_income_p90p100 +
    unemployment_rate + # or poverty, depends on the best
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)

summary(model_property_5)
```

```{r}
# Violent
model_violent_5 <- plm(
  Data.Rates.Violent.All ~ crime_lag +
    log_gdp + 
    share_pretax_income_p90p100 +
    unemployment_rate +
    prison_population +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)

summary(model_violent_5)
```






We first examine the relationship between GDP and violent / property crime rates. Economic theory suggests that GDP should be a stronger predictor of property crime (primarily motivated by financial need) than of violent crime, which is driven by more complex social and psychological factors (Becker, 1968).




The panel regression results reveal a contrast between the two types of crime, that we had initially planned.

For property crime, GDP explains approximately 69% of the within-state variation (R² = 0.69), which is consistent with economic theories on crime suggesting that property offences are motivated by financial need (Becker, 1968).

As for violent crime, GDP alone fails to significantly predict violent crime rates (R² = 0.15), indicating that violent offences are driven by factors beyond economic conditions.

We then add income inequality, using the share of pre-tax income accruing to the top 10% of the distribution, as provided by the World Inequality Database. A higher share indicates greater income concentration at the top, which could be associated with increased social tension and crime rates (Fajnzylber, Lederman, and Loayza, 2002).

```{r}
model_property_2 <- plm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within"
)

model_violent_2 <- plm(
  Data.Rates.Violent.All ~ log_gdp + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within"
)
```


$$Crime_{it} = \alpha_i + \beta_1 \log(GDP_{it}) + \beta_2 \cdot Inequalities_{it} + \beta_3 \cdot Consumption_{it} + \beta_4 \cdot Unemployment_{it} + \beta_5 \cdot Population_{it} + \epsilon_{it}$$


```{r}
test_property <- plm(
  Data.Rates.Property.All ~ log_gdp +
    share_pretax_income_p90p100 +
    Consumption +
    unemployment_rate + 
    Data.Population,
  data  = panel_reg,
  index = c("State", "Year"),
  model = "within"
)
```

```{r}
test_violent <- plm(
  Data.Rates.Violent.All ~ log_gdp +
    share_pretax_income_p90p100 +
    Consumption +
    unemployment_rate + 
    Data.Population,
  data  = panel_reg,
  index = c("State", "Year"),
  model = "within"
)
```

```{r}
summary(test_violent)
```

```{r}
test_property_2 <- plm(
  Data.Rates.Property.All ~ log_gdp +
    share_pretax_income_p90p100 +
    Consumption +
    unemployment_rate + 
    Data.Population,
  data  = panel_reg,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)
```

```{r}
summary(test_property_2)
```

```{r}
test_violent_2 <- plm(
  Data.Rates.Violent.All ~ log_gdp +
    share_pretax_income_p90p100 +
    Consumption +
    unemployment_rate + 
    Data.Population,
  data  = panel_reg,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)
```

```{r}
summary(test_violent_2)
```

```{r}
modelsummary(
  list(
    "Model 1" = test_property,
    "Model 2" = test_property_2,
    "Model 3" = test_violent,
    "Model 4" = test_violent_2
  ),
  title = "Property crime: Panel regression results",
  stars = TRUE,
  gof_omit = "IC|Log|RMSE",
  output = "kableExtra"
) |>
  kable_styling(latex_options = "HOLD_position")
```


Finally, we add year fixed effects to control for national trends (e.g., federal policies, economic cycles) that affect all states simultaneously.

```{r}
model_property_3 <- plm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)

model_violent_3 <- plm(
  Data.Rates.Violent.All ~ log_gdp + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)
```

```{r}
summary(model_property_3)
```

```{r}
summary(model_violent_3)
```

Model 3 shows that the GDP-inequalities-crime relationship is mainly driven by the common temporal trend (all states are becoming wealthier and are seeing a decline in crime at the same time), rather than by dynamics specific to each state.

```{r}
modelsummary(
  list(
    "Model 1" = model_property_1,
    "Model 2" = model_property_2,
    "Model 3" = model_property_3
  ),
  title = "Property crime: Panel regression results",
  stars = TRUE,
  gof_omit = "IC|Log|RMSE",
  output = "kableExtra"
) |>
  kable_styling(latex_options = "HOLD_position")
```

For property crime (Table 1), GDP shows a strong negative association ($β ≈ -1875$, $p < 0.001$), explaining about 70% of within-state variation (Model 1). Adding inequality improves the fit marginally, with higher income concentration associated with lower property crime ($β = -874$, $p < 0.05$).

As a robustness check, Model 3 adds year fixed effects. The R² drops substantially (0.005), indicating that the GDP-crime relationship primarily reflects shared national trends rather than state-specific dynamics. This is consistent with the well-documented "great crime decline" - also visible in our first graph - that affected all U.S. states from the 1990s onward.

```{r}
modelsummary(
  list(
    "Model 1" = model_violent_1,
    "Model 2" = model_violent_2,
    "Model 3" = model_violent_3
  ),
  title = "Violent crime: Panel regression results",
  stars = TRUE,
  gof_omit = "IC|Log|RMSE",
  output = "kableExtra"
) |>
  kable_styling(latex_options = "HOLD_position")
```

For violent crime (Table 2), the results confirm our theoretical expectations: GDP has a weaker association ($β ≈ -100$, $R² = 0.15$), and inequality is only marginally significant ($p < 0.10$). Economic factors alone cannot explain violent crime patterns.

##### Between model

```{r}
model_between <- plm(
  Data.Rates.Property.All ~ log(gdp) + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "between"
)
```

```{r}
summary(model_between)
```

##### Random model

```{r}
model_random_property <- plm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "random"
)

model_random_violent <- plm(
  Data.Rates.Violent.All ~ log_gdp + share_pretax_income_p90p100,
  data = panel_reg,
  index = c("State", "Year"),
  model = "random"
)
```

```{r}
summary(model_random_property)
summary(model_random_violent)
```

##### Test de Hausman

```{r}
hausman_property <- phtest(
  model_property_3,        # Fixed effects (two-ways)
  model_random_property    # Random effects
)

hausman_property
```

```{r}
hausman_violent <- phtest(
  model_violent_3,
  model_random_violent
)

hausman_violent
```





Our estimates capture associations, not causal effects. Indeed, high crime may reduce GDP or increase prison population, which implies reverse causality. Moreover, there are omitted variables in our work, for instance time-varying factors like policing strategies, population structure and demographic shift may confounf our estimates.


### **Short-run analysis (2015–2018) - Contemporary correlates of crime**

#### Descriptive analysis

##### Descriptive overview of crime and new covariates

Summary statistics :

```{r}

panel_recent <- panel_full |>
  filter(Year >= 2015, Year <= 2018)

panel_recent_tbl <- panel_recent |>
  mutate(
    log_gdp = log(gdp),
    shootings_per_million = 1e6 * nb_police_shootings / Data.Population,
    lpr_per_million       = 1e6 * lpr_total / imm_population
  )

vars_2 <- c(
  # Crime
  "Data.Rates.Violent.All",
  "Data.Rates.Property.All",

  # Economic structure
  "log_gdp",
  "share_pretax_income_p90p100",

  # Immigration & police
  "lpr_per_million",
  "shootings_per_million",

  # Public spending
  "spending_education",
  "spending_welfare",
  "spending_health",
  "spending_corrections",
  "spending_police",

  # Food assistance (USDA)
  "wic_2015",
  "nslp_2015",
  "sbp_2015"
)

summary_recent <- panel_recent_tbl |>
  select(any_of(vars_2)) |>
  pivot_longer(everything(), names_to = "variable", values_to = "value") |>
  summarise(
    N      = sum(!is.na(value)),
    Mean   = mean(value, na.rm = TRUE),
    SD     = sd(value, na.rm = TRUE),
    P10    = quantile(value, 0.10, na.rm = TRUE),
    Median = median(value, na.rm = TRUE),
    P90    = quantile(value, 0.90, na.rm = TRUE),
    .by = variable
  ) |>
  mutate(
    variable = recode(variable,
      # Crime
      "Data.Rates.Violent.All"      = "Violent crime rate (per 100k)",
      "Data.Rates.Property.All"     = "Property crime rate (per 100k)",

      # Economy / inequality
      "log_gdp"                     = "Log GDP",
      "share_pretax_income_p90p100" = "Top 10% pretax income share",

      # Immigration & police
      "lpr_per_million"             = "Lawful permanent residents per million",
      "shootings_per_million"       = "Police shootings per million",

      # Public spending
      "spending_education"          = "Public spending: education",
      "spending_welfare"            = "Public spending: welfare",
      "spending_health"             = "Public spending: health",
      "spending_corrections"        = "Public spending: corrections",
      "spending_police"             = "Public spending: police",

      # Food assistance
      "wic_2015"                    = "WIC participants (2015)",
      "nslp_2015"                   = "School lunch participants (2015)",
      "sbp_2015"                    = "School breakfast participants (2015)"
    )
  )

summary_recent |>
  knitr::kable(
    caption = "Summary statistics, short-run panel (2015–2018)",
    digits = 2,
    booktabs = TRUE
  ) |>
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

##### Contemporary heterogeneity and structural correlates (2015–2018)

```{r}
panel_recent <- panel_full |>
  filter(Year >= 2015, Year <= 2018) |>
  mutate(
    violent_rate  = Data.Rates.Violent.All,
    property_rate = Data.Rates.Property.All,
    log_gdp       = log(gdp),
    lpr_per_million = 1e6 * lpr_total / imm_population,
    shootings_per_million = 1e6 * nb_police_shootings / Data.Population
  )
  
```

```{r}
panel_recent <- panel_recent |>
  mutate(
    violent_quartile = ntile(violent_rate, 4)
  )

panel_recent <- panel_recent |>
  mutate(
    property_quartile = ntile(property_rate, 4)
  )
```

```{r}
quartile_table <- panel_recent |>
  group_by(violent_quartile) |>
  summarise(
    Mean_violent_crime = mean(violent_rate, na.rm = TRUE),
    Mean_property_crime = mean(property_rate, na.rm = TRUE),

    Log_GDP = mean(log_gdp, na.rm = TRUE),
    Inequality_top10 = mean(share_pretax_income_p90p100, na.rm = TRUE),

    LPR_per_million = mean(lpr_per_million, na.rm = TRUE),
    Police_shootings_per_million = mean(shootings_per_million, na.rm = TRUE),

    Welfare_spending = mean(spending_welfare, na.rm = TRUE),
    Police_spending  = mean(spending_police, na.rm = TRUE),

    WIC_participation  = mean(wic_2015, na.rm = TRUE),
    School_lunch_participation = mean(nslp_2015, na.rm = TRUE),
    .groups = "drop"
  ) |>
  mutate(
    violent_quartile = factor(
      violent_quartile,
      labels = c("Low crime", "Mid-low", "Mid-high", "High crime")
    )
  )
```

```{r}
quartile_table |>
  knitr::kable(
    caption = "Contemporary socio-economic characteristics by violent crime quartile (2015–2018)",
    digits = 2,
    booktabs = TRUE
  ) |>
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

```{r}
property_quartiles_tbl <- panel_recent |>
  group_by(property_quartile) |>
  summarise(
    Mean_property_crime = mean(property_rate, na.rm = TRUE),
    Mean_violent_crime  = mean(violent_rate, na.rm = TRUE),

    Log_GDP = mean(log_gdp, na.rm = TRUE),
    Inequality_top10 = mean(share_pretax_income_p90p100, na.rm = TRUE),

    LPR_per_million = mean(lpr_per_million, na.rm = TRUE),
    Police_shootings_per_million = mean(shootings_per_million, na.rm = TRUE),

    Welfare_spending = mean(spending_welfare, na.rm = TRUE),
    Police_spending  = mean(spending_police, na.rm = TRUE),

    WIC_participation  = mean(wic_2015, na.rm = TRUE),
    School_lunch_participation = mean(nslp_2015, na.rm = TRUE),
    .groups = "drop"
  ) |>
  mutate(
    property_quartile = factor(
      property_quartile,
      labels = c("Low crime", "Mid-low", "Mid-high", "High crime")
    )
  )
```

```{r}
property_quartiles_tbl |>
  knitr::kable(
    caption = "Contemporary socio-economic characteristics by property crime quartile (2015–2018)",
    digits = 2,
    booktabs = TRUE
  ) |>
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

#### Regression analysis

## Conclusion and limitations
