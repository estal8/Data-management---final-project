---
title: "Socio-economic determinants of crime in U.S. states"
author: "Paula de Miguel Sánchez & Esther Allevi"
subtitle: "{{< words-sum body-note-ref >}} words"
format:
  wordcount-pdf: 
    toc: true
    number-sections: true
execute:
  echo: false
  warning: false
---

## Research question

Crime rates in the United States differ markedly across states and over time, even in the presence of common national trends. This project examines how crime co-evolves with economic conditions and socials characteristics at the state level, and whether these relationships differ between property and violent crime.

The core objective of the analysis is to document robust within-state associations between crime and key economic and social variables, such as economic activity, unemployment, poverty, income inequality, incarceration and alcohol consumption, using a long state-level panel over the period 1998–2018. By relying on fixed effects models, we focus on how changes within a given state are associated with changes in crime, while controlling for unobserved state characteristics and nationwide shocks.

In a second, complementary step, we conduct a short-run exploratory analysis (2015–2018) to incorporate additional institutional and social indicators that are only available for recent years, including police shootings, immigration flows and public spending. Given the limited time dimension, this part of the analysis is descriptive and aims to highlight contemporaneous cross-state correlations rather than causal effects.

Principally, the project asks whether economic and social variables are more strongly associated with property crime than with violent crime, and to what extent crime dynamics exhibit persistence beyond contemporaneous economic conditions.

## Brief dataset description

We built our panel by usind nine different sources :

-   Property and Violent crime rates (FBI/CORGIS, 1960–2019) ;

-   Income inequality providing top income shares by state (WID, 1960–2018);

-   GDP and consumption per capita (BEA Regional Accounts, 1998–2023);

-   Unemployment rate (BLS, 1976-2025);

-   Prison population (The Sentencing Project, 1980–2022) ;

-   Poverty rates (Census Bureau, 1980–2023);

-   Beer consumption per capita for population aged 14+ (NIAAA, 1970–2022);

-   Immigration flows covering legal residents, refugees and asylees (DHS, 2013–2023);

-   Police shootings (Washington Post, 2015–2024);

-   Public spending on education, welfare, health, corrections and police (Census Bureau, 2017–2023);

-   Food assistance participation (USDA Food Environment Atlas, 2012-2023).

Full descriptions are provided in the data cleaning document (Phase 2).

## Data analysis

This empirical analysis is divided into two parts, reflecting the heterogeneous temporal coverage of our sources.

The crime, inequality, GDP, consumption, unemployment, prison population, poverty, and alcohol series provide consistent state-year observations between 1998-2018. It allows us to examine the structural relationships between economic conditions and crime using fixed effects panel regressions.

In contrast, immigration flows, police shootings, public spending and food access are only available for recent years (2015-2018). Considering the lack of historical depth, but also the value of these contemporary indicators, we conduct an exploratory analysis, that should be interpreted accordingly.

### **Long-run analysis (1998–2018)**

#### Descriptive analysis

```{r}
#| message: false

library(ggplot2)
library(plm)
library(dplyr)
library(tidyverse)
library(here)
library(vroom)
library(car)
library(modelsummary)
library(sandwich)
library(kableExtra)
library(lmtest)
library(corrplot)
```

```{r}
#| message: false

here::i_am("Data-management---final-project.Rproj")
panel_full <- vroom(here("DATA_panel_full.csv"))
panel_full_final <- vroom(here("DATA_panel_full_final.csv"))
```

##### National long-run trends in crime (1998-2018)

To establish a benchmark for the subsequent analysis, we first document the long-run evolution of violent and property crime across U.S. states. Figure 1 displays the average crime rate across states together with the 10th–90th percentile range, providing a synthetic view of both aggregate dynamics and cross-state heterogeneity.

```{r}
panel_long <- panel_full |>
  filter(Year <= 2018)
crime_distribution <- panel_long |>
  group_by(Year) |>
  summarise(
    violent_mean = mean(Data.Rates.Violent.All, na.rm = TRUE),
    violent_p10  = quantile(Data.Rates.Violent.All, 0.10, na.rm = TRUE),
    violent_p90  = quantile(Data.Rates.Violent.All, 0.90, na.rm = TRUE),

    property_mean = mean(Data.Rates.Property.All, na.rm = TRUE),
    property_p10  = quantile(Data.Rates.Property.All, 0.10, na.rm = TRUE),
    property_p90  = quantile(Data.Rates.Property.All, 0.90, na.rm = TRUE),
    .groups = "drop"
  ) |>
  pivot_longer(
    cols = -Year,
    names_to = c("type", "stat"),
    names_pattern = "(violent|property)_(mean|p10|p90)",
    values_to = "value"
  ) |>
  mutate(
    type = dplyr::recode(
    type,
    violent  = "Violent crime",
    property = "Property crime")
    ) |>
  pivot_wider(names_from = stat, values_from = value)
```

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_distribution, aes(x = Year)) +
  geom_ribbon(aes(ymin = p10, ymax = p90), alpha = 0.25) +
  geom_line(aes(y = mean), linewidth = 0.9) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    caption = "Figure 1. National crime trends and cross-state dispersion (mean and 10th-90th percentiles, 1960-2018)",
    x = "Year",
    y = "Crimes per 100,000 inhabitants"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Both crime categories exhibit a pronounced common time profile, with a strong increase from the 1960s to the late 1980s or early 1990s, followed by a sustained decline. Despite these shared national trends, cross-state heterogeneity remains large throughout the entire period, as illustrated by the wide percentile bands.

Property crime displays a particularly strong rise and fall, whereas violent crime peaks later and declines more gradually, suggesting distinct underlying mechanisms. The persistence of substantial dispersion across states indicates that national trends alone cannot account for observed crime dynamics and highlights the relevance of state-specific factors.

Due to data availability constraints, our focus will be on the period 1998-2018, in the midst of a crime decline in the US states.

##### Evolution of violent crime and property crime among high-crime states

```{r}
top_states <- panel_full |>
  filter(Year <= 2018) |>
  group_by(State) |>
  summarise(mean_violent = mean(Data.Rates.Violent.All, na.rm = TRUE)) |>
  arrange(desc(mean_violent)) |>
  slice_head(n = 8) |>
  pull(State)

crime_by_state_top <- panel_full |>
  filter(Year <= 2018, State %in% top_states) |>
  select(State, Year, Data.Rates.Violent.All, Data.Rates.Property.All) |>
  pivot_longer(
    cols = c(Data.Rates.Violent.All, Data.Rates.Property.All),
    names_to = "type",
    values_to = "rate"
  ) |>
  mutate(
    type = case_when(
      type == "Data.Rates.Violent.All" ~ "Violent crime",
      type == "Data.Rates.Property.All" ~ "Property crime"
    )
  )
```

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_by_state_top, aes(x = Year, y = rate, colour = State)) +
  geom_line(linewidth = 0.7) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    caption = "Figure 2. Violent and property crime rates in the eight highest-crime U.S. states (1960-2018)",
    x = "Year",
    y = "Crimes per 100,000 inhabitants",
    colour = "State"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Figure 2 displays the crime trends for the eight states with the highest crime rate per 100 000 inhabitants between 1960 and 2018. Despite differences in levels, all states exhibit similar trends : a strong increase until the late 1980s or early 1990s, followed by a sustained decline. Cross-state heterogeneity also remains pronounced. 

The District of Columbia stands out, both for its higher levels and for its volatility, which might reflect its unique urban and institutional characteristics. This makes it difficult to compare it with US states. While it is included in this descriptive analysis, it is excluded from the regression sample due to missing values for key variables and to its unique characteristics as a federal district (no state-level governance, extreme urbanization).

##### Summary statistics

```{r}
panel_reg <- panel_full_final |>
  filter(Year >= 1998 & Year <= 2018) |>
  filter(State != "District of Columbia") |>
  mutate(log_gdp = log(gdp), log_pop = log(Data.Population))
```

```{r}
panel_reg |>
  select(
    `Property crime (per 100k)` = Data.Rates.Property.All,
    `Violent crime (per 100k)` = Data.Rates.Violent.All,
    `Log GDP` = log_gdp,
    `Top 10% pretax income share` = share_pretax_income_p90p100,
    `Unemployment rate (%)` = unemployment_rate,
    `Poverty rate (%)` = percent_poor,
    `Prison per 100k` = prison_per_100k,
    `Beer per capita (gallons)` = beer_per_capita_14plus,
    `Consumption per capita` = Consumption
  ) |>
  pivot_longer(everything(), names_to = "Variable", values_to = "value") |>
  group_by(Variable) |>
  summarise(
    N = sum(!is.na(value)),
    Mean = mean(value, na.rm = TRUE),
    SD = sd(value, na.rm = TRUE),
    Min = min(value, na.rm = TRUE),
    Median = median(value, na.rm = TRUE),
    Max = max(value, na.rm = TRUE),
    .groups = "drop"
  ) |>
  knitr::kable(digits = 2, booktabs = TRUE) |>
  kableExtra::kable_styling(latex_options = c("HOLD_position", "scale_down"))
```

Property crime averages 3,069 per 100,000 inhabitants (SD = 865.26), while violent crime averages 393 (SD = 168.27). All variables show substantial cross-state variation.

##### Descriptive co-movement with economic structure

```{r}
#Before imposing a linear model, do crime rates co-move with economic conditions and inequality in the raw data, once we pool state–year observations?

crime_gdp <- panel_long |>
  filter(!is.na(gdp)) |>
  transmute(
    Year,
    log_gdp = log(gdp),
    property = Data.Rates.Property.All,
    violent  = Data.Rates.Violent.All
  ) |>
  pivot_longer(
    cols = c(property, violent),
    names_to = "type",
    values_to = "crime"
  ) |>
  mutate(
    type = dplyr::recode(
    type,
    violent  = "Violent crime",
    property = "Property crime")
    )
```

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_gdp, aes(x = log_gdp, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Log state GDP",
    y = "Crimes per 100,000 inhabitants",
    caption = "Figure 3. Raw co-movement between crime and GDP (pooled state-year observations))"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

The pooled scatter plot reveals a non-linear relationship between property crime and state GDP. Property crime increases at low GDP levels before declining at higher levels, consistent with the opportunity cost hypothesis. However, substantial dispersion around the fitted curve indicates that GDP alone cannot explain cross-state differences in property crime.

In contrast, violent crime shows a weaker association to GDP. While crime rises sharply at low GDP, the relationship flattens at higher levels with no clear monotonic decline. This suggests violent crime is less tied to economic performance and more driven by social, institutional, and demographic factors.

```{r}
crime_ineq <- panel_long |>
  filter(!is.na(share_pretax_income_p90p100)) |>
  transmute(
    Year,
    inequality = share_pretax_income_p90p100,
    property = Data.Rates.Property.All,
    violent  = Data.Rates.Violent.All
  ) |>
  pivot_longer(
    cols = c(property, violent),
    names_to = "type",
    values_to = "crime"
  ) |>
  mutate(
    type = dplyr::recode(
    type,
    violent  = "Violent crime",
    property = "Property crime")
    )
```

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

ggplot(crime_ineq, aes(x = inequality, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    caption = "Figure 4. Raw co-movement between crime and income inequality (pooled state-year observations)",
    x = "Top 10% pre-tax income share",
    y = "Crimes per 100,000 inhabitants"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Property crime exhibits a non-linear and noisy relationship with inequality, peaking at intermediate levels. This suggests inequality matters for property crime, though not monotonically. Wide  dispersion indicates important unobserved state characteristics.

Violent crime shows a stronger association with inequality, rising sharply with inequality from low to intermediate levels before declining slightly at very high inequality. This aligns with theories linking violent crime to social fragmentation and relative deprivation rather than economic incentives.

```{r}
crime_remaining_covariates <- panel_full_final |>
  select(
    State, Year,
    Data.Rates.Property.All,
    Data.Rates.Violent.All,
    unemployment_rate,
    percent_poor,
    Consumption,
    beer_per_capita_14plus,
    prison_per_100k
  ) |>
  filter(!is.na(prison_per_100k)) |>
  pivot_longer(
    cols = c(Data.Rates.Property.All, Data.Rates.Violent.All),
    names_to = "type",
    values_to = "crime"
  ) |>
  mutate(
    type = dplyr::recode(
      type,
      "Data.Rates.Violent.All"  = "Violent crime",
      "Data.Rates.Property.All" = "Property crime"
    )
  )
```

The 5 following figures presents pooled scatter plots relating crime rates to key socio-economic variables across state-year observations.

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

crime_remaining_covariates |>
  ggplot(aes(x = unemployment_rate, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", formula = y ~ x, se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Unemployment rate (%)",
    y = "Crimes per 100,000 inhabitants",
    caption = "Figure 5. Raw co-movement between crime and unemployment rate (pooled state-year observations)"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

The relationship between unemployment and crime appears weak and non-linear. Property crime peaks at intermediate unemployment levels, while violent crime rises modestly with unemployment. The substantial dispersion suggests unemployment alone is not a strong crime predictor.

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

crime_remaining_covariates |> 
  ggplot(aes(x = percent_poor, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", formula = y ~ x, se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Share of population below poverty line (%)",
    y = "Crimes per 100,000 inhabitants", 
    caption = "Figure 6. Raw co-movement between crime and percentage of poor (pooled state-year observations)"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Poverty displays a modest positive association with both crime types, slightly stronger for violent crime. However, substantial dispersion around the LOESS curve indicates poverty alone poorly predicts crime across states.

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

crime_remaining_covariates |> 
ggplot(aes(x = Consumption, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", formula = y ~ x, se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Consumption per capita",
    y = "Crimes per 100,000 inhabitants",
    caption = "Figure 7. Raw co-movement between crime and consumption per capita (pooled state-year observations)"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Consumption per capita shows a clear negative association with both crime types. States with higher living standards systematically experience lower property and violent crime rates.

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

crime_remaining_covariates |> 
ggplot(aes(x = beer_per_capita_14plus, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", formula = y ~ x, se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Beer consumption per capita (14+)",
    y = "Crimes per 100,000 inhabitants", 
    caption = "Figure 8. Raw co-movement between crime and beer consumption per capita (pooled state-year observations)"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Beer consumption per capita shows a non-linear, inverted-U relationship with crime. Property crime increases with beer consumption up to approximately 1.25 gallons per capita, then levels off. For violent crime, the pattern is similar but noisier. These graphs support the inclusion of alcohol as a criminogenic factor in our regression models.

```{r}
#| fig-width: 10
#| fig-height: 5
#| warning: false
#| message: false

crime_remaining_covariates |> 
ggplot(aes(x = prison_per_100k, y = crime)) +
  geom_point(alpha = 0.25, size = 0.8) +
  geom_smooth(method = "loess", formula = y ~ x, se = FALSE, linewidth = 1) +
  facet_wrap(~ type, scales = "free_y") +
  labs(
    x = "Prison population per 100,000",
    y = "Crimes per 100,000 inhabitants",
    caption = "Figure 9. Raw co-movement between crime and prison population per 100 000 (pooled state-year observations)"
  ) +
  theme_minimal() +
  theme(plot.caption = element_text(size = 13, hjust = 0.5))
```

Prison population per 100 000 inhabitants is positively associated to both property and violent crime. States with higher incarceration rates tend to exhibit higher crime, likely reflecting reverse causality rather than failed deterrence.

Several variables display clear raw co-movements with crime, although the relationships are often non-linear and differ between property and violent crime. In particular, beer consumption and economic activity measures exhibit strong positive associations, while the relationship with unemployment and poverty appears weaker and less stable. These descriptive patterns motivate the regression strategy adopted in the following section.

#### Regression analysis

Taken together, the descriptive evidence suggests that crime rates in U.S. states co-evolve with economic conditions and income inequality, but that these relationships are heterogeneous and potentially confounded by persistent state-specific characteristics and common national shocks. To account for these factors and move beyond raw correlations, we now estimate panel regressions with state and year fixed effects, which exploit within-state variation over time while controlling for unobserved heterogeneity.

##### Hypotheses and control variables

We test the following hypotheses:

-   **H1 (opportunity cost)** : Higher GDP (or consumption) is associated with lower crime rates, particularly for property crime.
-   **H2 (inequality)** : Greater income concentration at the top of the distribution is associated with higher crime rates.
-   **H3 (deterrence)** : Larger prison populations are associated with lower crime rates because of incapacitation of criminals.
-   **H4 (alcohol as a criminogenic factor)** : Higher alcohol consumption is associated with higher violent crime rates.
-   **H5 (crime persistence)** : Crime rates exhibit temporal inertia, i.e. past crime is a strong predictor of current crime (it encourages or discourages entry, it owerwhelms law enforcers…).

We estimate different models for property and violent crime, as property crime is more directly linked to economic incentives (Becker, 1968), while violent crime may be more linked to specific social factors.

We distinguish between variables of primary interest, which directly test our hypotheses, and control variables, which reduce omitted variable bias.

```{r}
#| tbl-cap: "Variables of interest and controls"

all_variables <- tibble(
  Variable = c(
    "Log(GDP) or Consumption",
    "Inequality (top 10% share)",
    "Prison population per 100k",
    "Beer consumption per capita",
    "Lagged crime",
    "Unemployment rate",
    "Poverty rate"
  ),
  Type = c(
    "Primary",
    "Primary",
    "Primary",
    "Primary",
    "Primary",
    "Control",
    "Control"
  ),
  `Hypothesis / Rationale` = c(
    "H1: Opportunity cost",
    "H2: Income concentration",
    "H3: Deterrence/incapacitation",
    "H4: Alcohol as criminogenic factor",
    "H5: Crime persistence",
    "Labour market slack",
    "Persistent economic hardship"
  )
)

all_variables |>
  knitr::kable(booktabs = TRUE) |>
  kableExtra::kable_styling(latex_options = "HOLD_position") |>
  kableExtra::pack_rows("Variables of primary interest", 1, 5) |>
  kableExtra::pack_rows("Control variables", 6, 7)
```

We include unemployment and poverty as controls because they capture dimensions of economic stress that are conceptually distinct from aggregate GDP (a state's economy may grow while unemployment rises or poverty persists, creating divergent effects on crime). Poverty reflects the lower tail of the income distribution, which may affect crime differently than top income concentration. 

##### Tests

Before presenting our results, we conduct a series of tests to validate our approach.

```{r}
panel_data <- pdata.frame(panel_reg, index = c("State", "Year"))

model_pooled <- plm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100 + 
    unemployment_rate + prison_per_100k + beer_per_capita_14plus + percent_poor,
  data = panel_data, model = "pooling"
)

model_fe <- plm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100 + 
    unemployment_rate + prison_per_100k + beer_per_capita_14plus + percent_poor,
  data = panel_data, model = "within"
)

model_re <- plm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100 + 
    unemployment_rate + prison_per_100k + beer_per_capita_14plus + percent_poor,
  data = panel_data, model = "random"
)
```

The first question is whether state-level heterogeneity exists. We test this using two complementary approaches.

```{r}
# F-test (pooled vs fixed effects)
f_test <- pFtest(model_fe, model_pooled)

# Breusch-Pagan LM (pooled vs random effects)
bp_test <- plmtest(model_pooled, type = "bp")

tests_table <- tibble(
  Test = c(
    "F-test (Pooled vs FE)",
    "Breusch-Pagan LM (Pooled vs RE)"
  ),
  Statistic = c(
    as.numeric(f_test$statistic),
    as.numeric(bp_test$statistic)
  ),
  `p-value` = c(
    f_test$p.value,
    bp_test$p.value
  )
)

tests_table |>
  mutate(
    `p-value` = ifelse(`p-value` < 1e-4, "< 0.0001", round(`p-value`, 4))
  ) |>
  knitr::kable(
    digits = 4,
    caption = "F-test and Breusch-Pagan LM test results"
  )
```

The F-test compares the fixed effects model against pooled OLS. The null hypothesis is that all state fixed effects are jointly equal to zero ($H_0 = \alpha_{1} = … = \alpha_{2}$). We obtain $F=148.4$ with $p<0.001$. Thus, the F-test strongly rejects the null hypothesis that state fixed effects are jointly zero, indicating that pooled OLS is inappropriate.

The Breusch-Pagan Lagrange Multiplier test provides a complementary check. It tests whether the variance of individual effects is zero ($H_0: \sigma^2_\alpha = 0$). We obtain $\chi^2 = 2981.1$ with $p<0.001$, which allows us to reject the null hypothesis.

These tests confirm that individual effects are present and statistically significant. Having established that, we still have to choose between random effects and fixed effects. To do so, we use the Hausman test :

```{r}
# Hausman (fixed vs random effects)
hausman_test <- phtest(model_fe, model_re)

tests_table <- tibble(
  Test = "Hausman (FE vs RE)",
  Statistic = as.numeric(hausman_test$statistic),
  `p-value` = hausman_test$p.value,
)

tests_table |>
  mutate(
    `p-value` = ifelse(`p-value` < 1e-4, "< 0.0001", round(`p-value`, 4))
  ) |>
  knitr::kable(
    digits = 4,
    caption = "Hausman test results (fixed vs random effects)"
  )
```

Under $H_0$, both fixed effects and random effects are consistent, but random effects is more efficient ; under $H_1$, only fixed effects is consistent. We obtain $\chi^2 = 599.8$ with $p<0.001$, so we can reject $H_0$.

This indicates that state-specific effects are correlated with our explanatory variables (GDP, inequality, etc.), which makes sense since wealthier states likely have different unobserved characteristics than poorer states.

Next, we test for autocorrelation and heteroscedasticity. Because of the nature of crime according to our hypothesis (persistence), and of our explanatory variables (GDP, inequalities, prison population, etc change slowly over time), we may expect serial correlation. Moreover, heteroscedasticity is also plausible given the variation in state size and crime levels. Smaller states might experience more volatility in their crime rates because small absolute changes translate into large percentage changes.

```{r}
# Autocorrelation test (Breusch-Godfrey)
bg_test <- pbgtest(model_fe, order = 1)

# Heteroscedasticity test (Breusch-Pagan)
bp_hetero <- bptest(model_fe)

tests_table <- tibble(
  Test = c("Breusch–Godfrey, AR(1)", "Breusch–Pagan"),
  Statistic = c(
    as.numeric(bg_test$statistic),
    as.numeric(bp_hetero$statistic)
  ),
  `p-value` = c(bg_test$p.value, bp_hetero$p.value)
)

tests_table |>
  mutate(
    `p-value` = ifelse(`p-value` < 1e-4, "< 0.0001", round(`p-value`, 4))
  ) |>
  knitr::kable(
    digits = 4,
    caption = "Specification tests for the fixed-effects model"
  )
```

The specification tests reveal two issues, serial correlation and heteroscedasticity. They do not bias our coefficient estimates but invalidate classic standard errors, potentially leading to misleading significance levels. So, we compute robust standard errors, clustered at the state level, and compare them with the correlated and heterodastic standard errors.

```{r}
robust_se <- vcovHC(model_fe, type = "HC1", cluster = "group")
```

```{r}
var_labels <- c(
  "log_gdp" = "Log(GDP)",
  "Consumption" = "Consumption",
  "share_pretax_income_p90p100" = "Inequality (top 10%)",
  "unemployment_rate" = "Unemployment rate",
  "prison_per_100k" = "Prison per 100k",
  "beer_per_capita_14plus" = "Beer per capita (14+)",
  "log_pop" = "Log(Population)",
  "percent_poor" = "Poverty (%)"
)

comparison <- tibble(
  Variable = names(coef(model_fe)),
  Coefficient = coef(model_fe),
  SE = sqrt(diag(vcov(model_fe))),
  SE_robust = sqrt(diag(robust_se))
) |>
  mutate(
    Variable = dplyr::recode(Variable, !!!var_labels),
    t = Coefficient / SE,
    t_robust = Coefficient / SE_robust,
    p = 2 * pt(-abs(t), df = model_fe$df.residual),
    p_robust = 2 * pt(-abs(t_robust), df = model_fe$df.residual)
  )

comparison |>
  knitr::kable(digits = 3, caption = "Comparison of classical vs robust standard errors")
```

Classical standard errors are 1.2 to 3.5 times smaller than robust standard errors, leading to inflated significance levels. For instance, prison population per 100 000 inhabitants appears significant with classical errors ($p < 0.001$) but becomes non-significant with robust errors ($p = 0.103$). Given these findings, all subsequent results use robust standard errors clustered by state.

Finally, we test for multicolinearity, using Variance Inflation Factors (VIF).

```{r}
model_all <- plm(
  Data.Rates.Property.All ~ log_gdp +
    Consumption +
    unemployment_rate +
    percent_poor +
    share_pretax_income_p90p100 +
    prison_per_100k +
    beer_per_capita_14plus +
    log_pop,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within"
)

vif_all <- car::vif(
  lm(
    Data.Rates.Property.All ~ log_gdp + Consumption + unemployment_rate +
      percent_poor + share_pretax_income_p90p100 + prison_per_100k +
      beer_per_capita_14plus + log_pop,
    data = panel_reg
  )
)

knitr::kable(
  round(vif_all, 2),
  col.names = "VIF",
  caption = "Variance inflation factors for all covariates"
)
```

We do not include GDP, consumption and population simultaneously because of the multicollinearity it clearly introduces. Instead, we will estimate alternative specifications to assess which measure is most strongly associated with crime (see following models). 

We choose not include log population in our specifications at all, for three reasons. First, it exhibits severe multicollinearity with log GDP, which would inflate standard errors and obscure the effects of economic conditions. Second, state fixed effects already absorb time-invariant differences in state size, and since population changes slowly over time, its within-state variation provides limited additional information beyond what is captured by the fixed effects. Third, the total population is not directly linked to any of our theoretical hypotheses; it is the composition of the population (age structure, demographic characteristics) that theory suggests might affect crime, not its absolute size. Unfortunately, detailed demographic breakdowns by state and year were not available in our dataset. Future research incorporating age structure or urbanization rates could provide additional insights.

For now, we look at the VIF when we only keep one variable among log(gdp) and consumption.

```{r}
model_ols <- lm(
  Data.Rates.Property.All ~ log_gdp + share_pretax_income_p90p100 + 
    unemployment_rate + prison_per_100k + percent_poor + beer_per_capita_14plus,
  data = panel_reg
)
knitr::kable(
  round(vif(model_ols), 2),
  col.names = "VIF",
  caption = "Variance inflation factors with log(gdp)"
)
```

```{r}
model_ols_2 <- lm(
  Data.Rates.Property.All ~ Consumption + share_pretax_income_p90p100 + 
    unemployment_rate + prison_per_100k + percent_poor + beer_per_capita_14plus,
  data = panel_reg
)

knitr::kable(
  round(vif(model_ols_2), 2),
  col.names = "VIF",
  caption = "Variance inflation factors with consumption"
)
```

Without consumption and GDP being included simultaneously, all VIF values are below 5, the conventional threshold for concern, so our explanatory variables are sufficiently independent.

```{r}
tests_summary <- tibble(
  Test = c("F-test (Pooled vs FE)", 
           "Breusch-Pagan LM", 
           "Hausman (FE vs RE)",
           "Breusch-Godfrey (autocorr.)",
           "Breusch-Pagan (heterosced.)"),
  Statistic = c(f_test$statistic, 
                bp_test$statistic, 
                hausman_test$statistic,
                bg_test$statistic,
                bp_hetero$statistic),
  p_value = c("< 0.001", "< 0.001", "< 0.001", "< 0.001", "< 0.001"),
  Decision = c(
    ifelse(f_test$p.value < 0.05, "FE needed", "Pooled OK"),
    ifelse(bp_test$p.value < 0.05, "Individual effects exist", "No effects"),
    ifelse(hausman_test$p.value < 0.05, "FE preferred", "RE acceptable"),
    ifelse(bg_test$p.value < 0.05, "Autocorrelation present", "No autocorrelation"),
    ifelse(bp_hetero$p.value < 0.05, "Heteroscedasticity present", "Homoscedastic")
  )
)

tests_summary |>
  knitr::kable(booktabs = TRUE, caption = "Summary of model specification tests results")
```

##### Models with fixed effects

Our objective is to document robust correlations between socio-economic variables and crime rates, not to establish causal effects. Considering our tests conclusions, we employ fixed effects panel regressions to control for time-invariant state characteristics.

We estimate four panel specifications with state fixed effects to assess the robustness of our findings. All models use robust standard errors clustered by state to account for serial correlation and heteroscedasticity.

Model 1 (Baseline) includes log GDP, inequality, unemployment, poverty, prison population, and beer consumption. This specification tests the baseline correlations between economic conditions and crime.

$$
\begin{aligned}
Crime_{it} =\ & \alpha_i 
+ \beta_1 \log(GDP_{it}) 
+ \beta_2 \cdot Inequality_{it} \\
& + \beta_3 \cdot Beer_{it} 
+ \beta_4 \cdot Prison_{it} \\
& + \gamma_1 \cdot Unemployment_{it} + \gamma_2 \cdot Poverty_{it}
+ \varepsilon_{it}
\end{aligned}
$$

where $\alpha_i$ denotes state fixed effects. The coefficients are identified from within-state variation over time.

We measure inequalities by using the share of pre-tax income accruing to the top 10% of the distribution, as provided by the World Inequality Database. A higher share indicates greater income concentration at the top, which could be associated with increased social tension and crime rates (Fajnzylber, Lederman, and Loayza, 2002).

```{r}
robust_vcov <- function(x) vcovHC(x, type = "HC1", cluster = "group")
```

```{r}
model_property_1 <- plm(
  Data.Rates.Property.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)
```

```{r}
model_violent_1 <- plm(
  Data.Rates.Violent.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)
```

Model 2 (Consumption) replaces $log(GDP)$ by $Consumption$. While GDP measures the size of the state economy, per capita consumption better captures household living standards. Comparing the two allows us to assess which dimension of economic conditions matters most for crime.

$$
\begin{aligned}
Crime_{it} =\ & \alpha_i 
+ \beta_1 \cdot Consumption_{it} 
+ \beta_2 \cdot Inequality_{it} \\
& + \beta_3 \cdot Beer_{it} 
+ \beta_4 \cdot Prison_{it} \\
& + \gamma_1 \cdot Unemployment_{it} + \gamma_2 \cdot Poverty_{it}
+ \varepsilon_{it}
\end{aligned}
$$

```{r}
model_property_2 <- plm(
  Data.Rates.Property.All ~ Consumption +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)
```

```{r}
model_violent_2 <- plm(
  Data.Rates.Violent.All ~ Consumption +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg,
  index = c("State", "Year"),
  model = "within",
)
```

Model 3 (Dynamic) adds lagged crime as an explanatory variable to test the persistence hypothesis (H5) (i.e., the tendency of high-crime states to remain high-crime). If crime exhibits inertia, the lagged coefficient should be positive and significant. We acknowledge that including a lagged dependent variable in fixed effects models introduces Nickell bias, which attenuates the coefficient toward zero when T is small. With T = 20 years, this bias is modest but not negligible. Results from Model 4 should therefore be interpreted cautiously, as the true persistence coefficient may be slightly higher than estimated.

$$
\begin{aligned}
Crime_{it} =\ & \alpha_i 
+ \theta \cdot Crime_{i,t-1} 
+ \beta_1 \log(GDP_{it}) \\
& + \beta_2 \cdot Inequality_{it} 
+ \beta_3 \cdot Beer_{it} \\
& + \beta_4 \cdot Prison_{it} + \gamma_1 \cdot Unemployment_{it} + \gamma_2 \cdot Poverty_{it} + \varepsilon_{it}
\end{aligned}
$$

```{r}
panel_dynamic <- panel_reg |>
  group_by(State) |>
  arrange(Year) |>
  mutate(property_lag = lag(Data.Rates.Property.All),
    violent_lag = lag(Data.Rates.Violent.All)
  ) |>
  ungroup() |>
  filter(!is.na(property_lag), !is.na(violent_lag), log_gdp > 0)
```

```{r}
model_property_3 <- plm(
  Data.Rates.Property.All ~ property_lag + 
    log_gdp + 
    share_pretax_income_p90p100 +
    unemployment_rate +
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_dynamic,
  index = c("State", "Year"),
  model = "within"
  )
```

```{r}
model_violent_3 <- plm(
  Data.Rates.Violent.All ~ violent_lag + 
    log_gdp + 
    share_pretax_income_p90p100 +
    unemployment_rate +
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_dynamic,
  index = c("State", "Year"),
  model = "within"
)
```

Model 4 (Two-ways) adds year fixed effects ($\delta_t$) to control for national trends affecting all states simultaneously (e.g., federal policies, economic cycles).

$$
\begin{aligned}
Crime_{it} =\ & \alpha_i 
+ \delta_t 
+ \theta \cdot Crime_{i,t-1} \\
& + \beta_1 \log(GDP_{it}) 
+ \beta_2 \cdot Inequality_{it} \\
& + \beta_3 \cdot Beer_{it} 
+ \beta_4 \cdot Prison_{it} \\
& + \gamma_1 \cdot Unemployment_{it} + \gamma_2 \cdot Poverty_{it}
+ \varepsilon_{it}
\end{aligned}
$$

```{r}
model_property_4 <- plm(
  Data.Rates.Property.All ~ property_lag +
    log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate +
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_dynamic,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)
```

```{r}
model_violent_4 <- plm(
  Data.Rates.Violent.All ~ violent_lag +
    log_gdp + 
    share_pretax_income_p90p100 +
    unemployment_rate +
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_dynamic,
  index = c("State", "Year"),
  model = "within",
  effect = "twoways"
)
```

##### Results

This table condensates all of our regression results for property crime :

```{r}
modelsummary(
  list(
    "Model 1" = model_property_1,
    "Model 2" = model_property_2,
    "Model 3" = model_property_3,
    "Model 4" = model_property_4
  ),
  vcov = robust_vcov,
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "log_gdp" = "Log GDP",
    "share_pretax_income_p90p100" = "Inequality (top 10%)",
    "unemployment_rate" = "Unemployment rate",
    "prison_per_100k" = "Prison per 100k",
    "beer_per_capita_14plus" = "Beer consumption",
    "property_lag" = "Property crime (t-1)",
    "Consumption" = "Consumption"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Robust standard errors clustered by state are in parenthesis",
  output = "kableExtra"
) |>
  kable_styling(latex_options = "HOLD_position")
```

This table presents the results of our 4 models for property crime, using robust standard errors clustered by state to account for serial correlation and heteroscedasticity.

The variable `log_gdp` shows a strong and consistent negative correlation with property crime. For instance, in the baseline model, a 10% increase in per state GDP is associated to about 151 fewer property crimes per 100 000 inhabitants ($β = -1509$, $p < 0.001$). This effect is attenuated but remains significant when controlling for crime persistence in Model 3 ($β = -244$, $p < 0.001$), and becomes non-significant in the two-way fixed effects specification in Model 4, $β = -105$, $p > 0.05$). This suggests that the crime-GDP relationship reflects national trends rather than state-specific dynamics.

Personal consumption expenditures, tested as an alternative measure to GDP in Model 2, shows a significant but smaller negative correlation ($β = -0.061$, $p < 0.001$). This confirms that household living standards, not just aggregate output, are negatively associated with property crime.

Neither unemployment rate nor poverty rate shows a significant correlation with property crime after controlling for other factors. In a similar fashion, the prison population per 100 000 inhabitants is not significantly correlated to property crime. These null findings contrasts with theoretical expectations. For unemployment, it is not consistent with the literature that shows that, during the 1990s, unemployment dropping caused, in part, an decrease in property crimes (Raphael & Winter-Ebmer, 2001). As control variables, their non-significance does not directly impact our hypotheses but suggests that aggregate labour market conditions and poverty rates do not strongly predict property crime once GDP is accounted for.

Beer consumption per capita is positively and significantly correlated with property crime across all specifications. In model 1, an increase of 1 gallons per capita is associated with approximately 1833 additional property crimes per 100,000 inhabitants ($p < 0.001$). The attenuation in Model 4 could be linked to the absorption of common trends by year fixed effects.

The lagged crime rate is the strongest predictor in dynamic specifications : in Model 3, a one-unit increase in the previous year's property crime rate is associated with a 0.79-unit increase in the current rate ($θ = 0.795$, $p < 0.001$). This coefficient remains stable in Model 4 : a one-unit increase in the previous year's property crime rate is associated with a 0.81-unit increase in the current rate ($θ = 0.811$, $p < 0.001$), confirming substantial crime inertia.

The baseline model explains 76% of within state variation ($R^2=0.761$). Adding lagged crime in models 3 and 4 increases $R^2$ up to 91%, indicating that past crime is a powerful predictor of current crime.

Thus, for property crime, GDP and consumption are negatively correlated with property crime, which partially confirms our first hypothesis. Alcohol consumption is positively correlated with property crime, supporting $H_4$. Finally, the crime persistence hypothesis ($H_5$) is strongly supported by our results.

This second table condensates our results for violent crimes :

```{r}
modelsummary(
  list(
    "Model 1" = model_violent_1,
    "Model 2" = model_violent_2,
    "Model 3" = model_violent_3,
    "Model 4" = model_violent_4
  ),
  vcov = robust_vcov,
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "log_gdp" = "Log GDP",
    "share_pretax_income_p90p100" = "Inequality (top 10%)",
    "unemployment_rate" = "Unemployment rate",
    "prison_per_100k" = "Prison per 100k",
    "beer_per_capita_14plus" = "Beer consumption",
    "Consumption" = "Consumption",
    "violent_lag" = "Violent crime (t-1)"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Robust standard errors clustered by state are in parenthesis",
  output = "kableExtra"
) |>
  kable_styling(latex_options = "HOLD_position")
```

The first three models fail to significantly predict violent crime rates as they explain only about 31% of within-state variation (R² = 0.31), which is substantially less than for property crime ($R^2 ≈ 0.76$). This might indicate that violent offences are driven by factors beyond economic conditions alone.

Unlike property crime, `log_gdp` shows no significant correlation with violent crime. Personal consumption is also non-significant. These findings imply that violent crimes are less motivated by economic need than property crimes, and might be more likely to be driven by conflicts or social disorganization.

Among control variables, unemployment rate shows a surprising negative correlation with violent crime in models 1-3 ($p < 0.001$). However, as a control variable, this result is incidental to our main hypotheses and should be interpreted with caution. The effect disappears in Model 4 after controlling for year fixed effects, suggesting it may capture only national time trends and not a structural relationship.

The top 10% income share is not significantly correlated with violent crime ($p > 0.05$ in all models), contrary to theoretical predictions linking inequality to social tension and violence.

Prison population per 100,000 inhabitants shows a small but positive and significant correlation with violent crime ($β ≈ 3.2$, $p < 0.05$ in Models 1-2). This might not imply that incarceration fail to decrease crime, but could reveal reverse causality issues, as states with higher violent crime rates incarcerate more people.

These findings lead us to reject hypothesis H3 (deterrence). The positive correlation between incarceration and crime does not support the deterrence hypothesis in our panel setting, likely due to reverse causality (states with more crime incarcerate more) overwhelming any potential deterrent effect.

As for beer consumption, it is again strongly and positively correlated with violent crime.

It's interesting to notice that adding lagged crime dramatically improves the models' fit ($R^2 ≈ 0.8$ in models 3 and 4). The crime persistence coefficient is large and highly significant ($θ = 0.833$). It indicates that violent crime exhibits even stronger inertia than property crime. Indeed, holding other factors constant, a state with 100 more violent crimes per 100 000 the past year will have 83 more violent crime the following year. But in these models, almost all variables that previously were significant lose their significance. This might indicate that their effect was linked to crime inertia. In the two-way fixed effect model (Model 4), only poverty remains slightly significant aside from lagged crime, but it has a negative coefficient.

To summarize our conclusions and rejection / support of our initial hypotheses, refer to this table : 

```{r}
#| tbl-cap: "Summary of findings by hypothesis"

hypothesis_summary <- tibble(
  Hypothesis = c(
    "H1: Opportunity cost",
    "H2: Inequality",
    "H3: Deterrence",
    "H4: Alcohol",
    "H5: Crime persistence"
  ),
  `Property Crime` = c(
    "Supported (GDP***, Consumption***)",
    "Not supported",
    "Not supported",
    "Supported (Beer***)",
    "Strongly supported (ρ ≈ 0.80***)"
  ),
  `Violent Crime` = c(
    "Not supported",
    "Not supported",
    "Not supported",
    "Partially supported (Models 1-3)",
    "Strongly supported (ρ ≈ 0.85***)"
  )
)

hypothesis_summary |>
  knitr::kable(booktabs = TRUE) |>
  kableExtra::kable_styling(
    latex_options = c("HOLD_position", "scale_down"),
    font_size = 9
  )
```

#### Robustness check

To assess the sensitivity of our results, we conduct two robustness checks. 

First, we exclude the three largest states by population (California, Texas, New York) to ensure they do not disproportionately drive our estimates.

```{r}
model_property_robust <- plm(
  Data.Rates.Property.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg |> filter(!State %in% c("California", "Texas", "New York")),
  index = c("State", "Year"),
  model = "within"
)

model_violent_robust <- plm(
  Data.Rates.Violent.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg |> filter(!State %in% c("California", "Texas", "New York")),
  index = c("State", "Year"),
  model = "within"
)
```

```{r}
modelsummary(
  list(
    "Property (full)" = model_property_1,
    "Property (excl. CA/TX/NY)" = model_property_robust,
    "Violent (full)" = model_violent_1,
    "Violent (excl. CA/TX/NY)" = model_violent_robust
  ),
  vcov = robust_vcov,
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "log_gdp" = "Log GDP",
    "share_pretax_income_p90p100" = "Inequality (top 10%)",
    "unemployment_rate" = "Unemployment rate",
    "prison_per_100k" = "Prison per 100k",
    "beer_per_capita_14plus" = "Beer consumption",
    "percent_poor" = "Poverty rate"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Robust standard errors clustered by state in parentheses.",
  output = "kableExtra"
) |>
  kable_styling(latex_options = c("HOLD_position", "scale_down"))
```

Excluding the three largest states yields nearly identical results. For property crime, the log GDP coefficient changes from -1,510 to -1,556, and beer consumption remains strongly significant. For violent crime, unemployment maintains its negative correlation and beer consumption becomes slightly more significant. This confirms our findings are not driven by large states.

Second, we exclude the highest-crime states to verify that our findings are not driven by outliers.

```{r}
high_crime_states <- panel_reg |>
  group_by(State) |>
  summarise(mean_crime = mean(Data.Rates.Violent.All, na.rm = TRUE)) |>
  arrange(desc(mean_crime)) |>
  slice_head(n = 3) |>
  pull(State)
```

```{r}
model_property_excl_hc <- plm(
  Data.Rates.Property.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg |> filter(!State %in% high_crime_states),
  index = c("State", "Year"),
  model = "within"
)

model_violent_excl_hc <- plm(
  Data.Rates.Violent.All ~ log_gdp +
    share_pretax_income_p90p100 +
    unemployment_rate + 
    prison_per_100k +
    beer_per_capita_14plus +
    percent_poor,
  data = panel_reg |> filter(!State %in% high_crime_states),
  index = c("State", "Year"),
  model = "within"
)
```

```{r}
modelsummary(
  list(
    "Property (full)" = model_property_1,
    "Property (excl. high-crime)" = model_property_excl_hc,
    "Violent (full)" = model_violent_1,
    "Violent (excl. high-crime)" = model_violent_excl_hc
  ),
  vcov = robust_vcov,
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "log_gdp" = "Log GDP",
    "share_pretax_income_p90p100" = "Inequality (top 10%)",
    "unemployment_rate" = "Unemployment rate",
    "prison_per_100k" = "Prison per 100k",
    "beer_per_capita_14plus" = "Beer consumption",
    "percent_poor" = "Poverty rate"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Robust standard errors clustered by state in parentheses.",
  output = "kableExtra"
) |>
  kable_styling(latex_options = c("HOLD_position", "scale_down"))
```

Excluding the three highest-crime states yields virtually identical results. Log GDP remains significantly negative for property crime ($β = -1480$ vs $-1510$), and beer consumption maintains its positive association with both crime types. 

The stability of coefficients across both robustness checks confirms that our findings are not driven by outlier states.

### **Short-run analysis (2015–2018) - Contemporary correlates of crime**

#### Descriptive analysis

##### Descriptive overview of crime and new covariates

We start the short-run analysis by describing crime rates and contemporaneous socio-economic variables over the period 2015–2018, which corresponds to the years for which the richest set of covariates is jointly available. Given the short time dimension, the objective is to document cross-state variation rather than long-run trends.

```{r}
panel_recent <- panel_full |>
  filter(Year >= 2015, Year <= 2018)

panel_recent_tbl <- panel_recent |>
  mutate(
    log_gdp = log(gdp),
    shootings_per_million = 1e6 * nb_police_shootings / Data.Population,
    lpr_per_million       = 1e6 * lpr_total / imm_population,

    unemployment_rate_pct = unemployment_rate,   # ya está en %
    poverty_rate_pct      = percent_poor,        # ya está en %
    prison_per_100k       = 1e5 * prison_population / Data.Population,
    alcohol_per_capita    = beer_per_capita_14plus,
    spending_education   = spending_education / 1e6,
    spending_welfare     = spending_welfare / 1e6,
    spending_health      = spending_health / 1e6,
    spending_corrections = spending_corrections / 1e6,
    spending_police      = spending_police / 1e6
  )
vars_2 <- c(
  # Crime
  "Data.Rates.Violent.All",
  "Data.Rates.Property.All",

  # Economic structure
  "log_gdp",
  "share_pretax_income_p90p100",

  # Immigration & police
  "lpr_per_million",
  "shootings_per_million",

  # Public spending
  "spending_education",
  "spending_welfare",
  "spending_health",
  "spending_corrections",
  "spending_police",

  # Food assistance 
  "wic_2015",
  "nslp_2015",
  "sbp_2015",
  
  # Socio-economic controls
  "unemployment_rate_pct",
  "poverty_rate_pct",
  "prison_per_100k",
  "alcohol_per_capita"
)
summary_recent <- panel_recent_tbl |>
  select(any_of(vars_2)) |>
  pivot_longer(everything(), names_to = "variable", values_to = "value") |>
  summarise(
    N      = sum(!is.na(value)),
    Mean   = mean(value, na.rm = TRUE),
    SD     = sd(value, na.rm = TRUE),
    P10    = quantile(value, 0.10, na.rm = TRUE),
    Median = median(value, na.rm = TRUE),
    P90    = quantile(value, 0.90, na.rm = TRUE),
    .by = variable
  ) |>
mutate(
variable = dplyr::recode(variable,
      
      "Data.Rates.Violent.All"      = "Violent crime rate",
      "Data.Rates.Property.All"     = "Property crime rate",

     
      "log_gdp"                     = "Log GDP",
      "share_pretax_income_p90p100" = "Top 10% pretax income share",

     
      "lpr_per_million"             = "Lawful permanent residents per million",
      "shootings_per_million"       = "Police shootings per million",

     
      "spending_education"          = "Public spending: education (in millions)",
      "spending_welfare"            = "Public spending: welfare (in millions)",
      "spending_health"             = "Public spending: health (in millions)",
      "spending_corrections"        = "Public spending: corrections (in millions)",
      "spending_police"             = "Public spending: police (in millions)",

      
      "wic_2015"                    = "WIC participants (2015)",
      "nslp_2015"                   = "School lunch participants (2015)",
      "sbp_2015"                    = "School breakfast participants (2015)",
      "unemployment_rate_pct"       = "Unemployment rate (%)",
      "poverty_rate_pct"            = "Poverty rate (%)",
      "prison_per_100k"             = "Prison population per 100k",
      "alcohol_per_capita"          = "Beer consumption per capita"
    )
  )

summary_recent |>
  knitr::kable(caption = "Summary statistics, short-run panel (2015–2018)",
               booktabs = TRUE, 
               digits = 2) |>
  kableExtra::kable_styling(
    latex_options = c("HOLD_position", "scale_down"),
    font_size = 9
  )
```

During 2015–2018, violent crime averages 385 incidents per 100,000 inhabitants, while property crime is far more prevalent, with an average of about 2,420 incidents per 100,000. Both crime types exhibit substantial cross-state dispersion, particularly property crime, indicating persistent heterogeneity in crime exposure.

Economic conditions vary moderately across states. Log GDP shows limited dispersion, while income concentration averages 46% for the top 10%, with meaningful cross-state variation. Unemployment rates are relatively low on average (around 4.4%), but poverty remains widespread, affecting roughly 12% of the population.

Migration and policing indicators also differ markedly across states. States host on average about 2,480 lawful permanent residents per million inhabitants, and police shootings occur at a rate of roughly 3.6 per million, both with substantial dispersion. Public spending variables display considerable heterogeneity but are only available for a limited number of years. Finally, institutional and behavioural factors vary across states, with average prison populations of 377 inmates per 100,000 inhabitants and moderate variation in beer consumption per capita.

##### Contemporary heterogeneity and structural correlates (2015–2018)

To further explore cross-state heterogeneity in the short run, we group state–year observations into quartiles of violent crime intensity and compare average socio-economic and institutional characteristics across these groups. Given the limited time dimension, this exercise is purely descriptive and aims to highlight contemporaneous correlations rather than dynamic effects.

```{r}
panel_recent <- panel_full |>
  filter(Year >= 2015, Year <= 2018) |>
  mutate(
    violent_rate  = Data.Rates.Violent.All,
    property_rate = Data.Rates.Property.All,
    log_gdp = log(gdp),
    lpr_pm = ifelse(imm_population > 0, 1e6 * lpr_total / imm_population, NA_real_),
    shoot_pm = ifelse(Data.Population > 0, 1e6 * nb_police_shootings / Data.Population, NA_real_),
    prison_100k = ifelse(Data.Population > 0, 1e5 * prison_population / Data.Population, NA_real_),
    violent_q  = ntile(violent_rate, 4),
    property_q = ntile(property_rate, 4)
  )

quartile_table <- panel_recent |>
  group_by(violent_q) |>
  summarise(
    VC      = mean(violent_rate, na.rm = TRUE),
    PC      = mean(property_rate, na.rm = TRUE),
    GDP     = mean(log_gdp, na.rm = TRUE),
    Ineq10  = mean(share_pretax_income_p90p100, na.rm = TRUE),
    LPRpm   = mean(lpr_pm, na.rm = TRUE),
    Shootpm = mean(shoot_pm, na.rm = TRUE),
    Unemp   = mean(unemployment_rate, na.rm = TRUE),
    Pov     = mean(percent_poor, na.rm = TRUE),
    Prison  = mean(prison_100k, na.rm = TRUE),
    Beer    = mean(beer_per_capita_14plus, na.rm = TRUE),
    WelfSp  = mean(spending_welfare, na.rm = TRUE),
    PoliceSp= mean(spending_police, na.rm = TRUE),
    WIC     = mean(wic_2015, na.rm = TRUE),
    Lunch   = mean(nslp_2015, na.rm = TRUE),
    .groups = "drop"
  ) |>
  mutate(
    Quartile = factor(
      violent_q,
      levels = 1:4,
      labels = c("Low", "Mid-low", "Mid-high", "High")
    )
  ) |>
  select(-violent_q)

violent_A <- quartile_table |>
  select(
    Quartile,
    VC, PC, GDP, Ineq10,
    Unemp, Pov, Prison
  )

violent_B <- quartile_table |>
  select(
    Quartile,
    Beer, LPRpm, Shootpm,
    WelfSp, PoliceSp, WIC, Lunch
  )

property_quartiles_tbl <- panel_recent |>
  group_by(property_q) |>
  summarise(
    PC      = mean(property_rate, na.rm = TRUE),
    VC      = mean(violent_rate, na.rm = TRUE),
    GDP     = mean(log_gdp, na.rm = TRUE),
    Ineq10  = mean(share_pretax_income_p90p100, na.rm = TRUE),
    LPRpm   = mean(lpr_pm, na.rm = TRUE),
    Shootpm = mean(shoot_pm, na.rm = TRUE),
    Unemp   = mean(unemployment_rate, na.rm = TRUE),
    Pov     = mean(percent_poor, na.rm = TRUE),
    Prison  = mean(prison_100k, na.rm = TRUE),
    Beer    = mean(beer_per_capita_14plus, na.rm = TRUE),
    WelfSp  = mean(spending_welfare, na.rm = TRUE),
    PoliceSp= mean(spending_police, na.rm = TRUE),
    WIC     = mean(wic_2015, na.rm = TRUE),
    Lunch   = mean(nslp_2015, na.rm = TRUE),
    .groups = "drop"
  ) |>
  mutate(
    Quartile = factor(
      property_q,
      levels = 1:4,
      labels = c("Low", "Mid-low", "Mid-high", "High")
    )
  ) |>
  select(-property_q)

property_A <- property_quartiles_tbl |>
  select(
    Quartile,
    PC, VC, GDP, Ineq10,
    Unemp, Pov, Prison
  )

property_B <- property_quartiles_tbl |>
  select(
    Quartile,
    Beer, LPRpm, Shootpm,
    WelfSp, PoliceSp, WIC, Lunch
  )

kable_pdf <- function(df, caption) {
  df |>
    knitr::kable(
      caption = caption,
      digits = 2,
      booktabs = TRUE
    ) |>
    kableExtra::kable_styling(
      latex_options = c("HOLD_position"),
      position = "center",
      font_size = 7
    )
}

kable_pdf(
  violent_A,
  "Contemporary characteristics by VIOLENT crime quartile (2015--2018) --- Panel A (crime \\& economy)"
)

kable_pdf(
  violent_B,
  "Contemporary characteristics by VIOLENT crime quartile (2015--2018) --- Panel B (society, institutions \\& programs)"
)

kable_pdf(
  property_A,
  "Contemporary characteristics by PROPERTY crime quartile (2015--2018) --- Panel A (crime \\& economy)"
)

kable_pdf(
  property_B,
  "Contemporary characteristics by PROPERTY crime quartile (2015--2018) --- Panel B (institutions \\& programs)"
)
```

States in the highest violent crime quartile experience, on average, nearly three times the violent crime rate of those in the lowest quartile, and also display substantially higher property crime rates. These high-crime states are characterised by worse labour market and social conditions, with unemployment rates exceeding 5% and poverty rates above 14%, compared to about 3.9% unemployment and 10.5% poverty in low-crime states.

Institutional and behavioural indicators also differ markedly across quartiles. Prison populations increase monotonically with violent crime intensity, rising from about 293 inmates per 100,000 inhabitants in low-crime states to over 470 per 100,000 in high-crime states. Police shootings per million inhabitants are almost twice as high in the highest violent crime quartile, suggesting higher levels of police–citizen confrontation or enforcement intensity in these states.

A similar pattern emerges when states are grouped by property crime quartiles. High property crime states combine higher violent crime rates, higher poverty, larger prison populations, and substantially more police shootings per capita. In contrast, differences in beer consumption per capita are relatively small across quartiles, suggesting that alcohol consumption varies less systematically with crime intensity in the short run.

Public spending and food assistance indicators show considerable dispersion but no clear monotonic pattern across quartiles, reflecting both institutional heterogeneity and the limited availability of these variables in the short-run sample.

This quartile-based comparison indicates that, even over a short horizon, states with higher crime rates tend to be characterised by greater economic stress, higher incarceration rates, and more intense police activity. These patterns motivate the regression analysis that follows, which formalises these associations while controlling for multiple dimensions simultaneously.

#### Regression analysis

Because the short-run panel only covers four years, we begin with a purely exploratory correlation analysis. The objective is not statistical inference, but rather to provide a preliminary overview of how violent and property crime co-move with a broad set of socio-economic and institutional variables, and to motivate a parsimonious and structured regression design.

Using the short-run panel, we compute pairwise correlations between crime rates and selected economic, social, and institutional indicators, including GDP, income inequality, unemployment, poverty, prison population, police activity, public spending, immigration, and alcohol consumption. The resulting correlation matrix is summarized using a heatmap.

```{r}
panel_sr <- panel_full |>
  filter(Year >= 2015, Year <= 2018) |>
  mutate(
    log_gdp = log(gdp),
    log_pop = log(Data.Population),
    shootings_per_million = 1e6 * nb_police_shootings / Data.Population,
    lpr_per_million = 1e6 * lpr_total / imm_population
  ) |>
  select(
    # Crime
    Data.Rates.Violent.All,
    Data.Rates.Property.All,

    # Economic conditions
    log_gdp,
    unemployment_rate,
    percent_poor,
    share_pretax_income_p90p100,

    # Institutions & policing
    prison_population,
    shootings_per_million,

    # Migration & behaviour
    lpr_per_million,
    beer_per_capita_14plus
  ) |>
  drop_na()

corr_mat <- cor(panel_sr)
```

```{r}
#| fig-width: 10
#| fig-height: 8
#| warning: false
#| message: false

corrplot(
  corr_mat,
  method = "color",
  type = "upper",
  tl.cex = 0.9,
  tl.col = "black",
  tl.srt = 45,
  diag = FALSE
)
```
The correlation matrix highlights clear short-run patterns. Both violent and property crime are positively correlated with unemployment and poverty, particularly for property crime, pointing to a close association with short-run economic conditions. Crime is also positively correlated with police shootings, indicating that high-crime states tend to face more intensive policing.

By contrast, log GDP and income inequality display only weak correlations with crime, while prison population is positively correlated with both crime and police shootings, consistent with institutional responses rather than deterrence effects. The correlations suggest a separation between socio-economic stress and institutional intensity, motivating a parsimonious regression strategy.

##### Hypotheses

We focus on four short-run hypotheses, mapped directly into two model blocks:

-   **H1 (economic stress)**: States experiencing worse economic conditions—higher unemployment and poverty—exhibit higher crime rates, especially property crime.
-   **H2 (inequality)**: Higher income concentration at the top of the distribution is associated with higher crime rates.
-   **H3 (institutional stress)**: Higher incarceration levels and policing activity are associated with different crime patterns, reflecting enforcement intensity rather than deterrence per se.
-   **H4 (behavioral factors)**: Higher alcohol consumption is positively associated with violent crime.

(H1–H2 are tested in the economic stress model; H3–H4 in the institutional model.)

##### Economic stress model (pooled OLS + year FE)

```{r}
panel_short <- panel_full_final

panel_short_inst <- panel_full_final |>
  filter(Year >= 2015, Year <= 2018) |>
  mutate(
    log_pop = log(Data.Population),
    log_gdp = log(gdp)
  ) |>
  drop_na(prison_population, nb_police_shootings, spending_police, 
          spending_corrections, beer_per_capita_14plus)
```

We use a parsimonious pooled OLS specification and include year fixed effects to absorb nationwide shocks common to all states.

$$\begin{aligned}
Crime_{it} =\ & \ \beta_0 + \beta_1 log(GDP_{it}) 
+ \beta_2 \ Unemployment_{it} \\
& + \beta_3 \ Poverty_{it} 
+ \beta_4 \ Inequality_{it} \\
& + \beta_5 \ log(Pop_{it}) 
+ \delta_t 
+ \varepsilon_{it}
\end{aligned}$$

where: $Crime_{it}$ denotes either violent or property crime in state i and year t, $\delta_t$ are year fixed effects capturing nationwide shocks.

This specification captures short-run associations between economic stress and crime without conditioning on potentially endogenous institutional responses.

```{r}
ols_property_econ <- lm(
  Data.Rates.Property.All ~ log_gdp +
    unemployment_rate +
    percent_poor +
    share_pretax_income_p90p100 +
    log_pop +
    factor(Year),
  data = panel_short_inst
)

ols_violent_econ <- lm(
  Data.Rates.Violent.All ~ log_gdp +
    unemployment_rate +
    percent_poor +
    share_pretax_income_p90p100 +
    log_pop +
    factor(Year),
  data = panel_short_inst
)

```

##### Institutions stress model (pooled OLS + year FE)

We estimate a separate specification focusing on contemporaneous institutional intensity and behavioral factors. These covariates are interpreted as descriptive correlates (not exogenous policy instruments), hence we keep them separate from economic stress variables.

$$\begin{aligned}
Crime_{it} =\ & \ \beta_0 
+ \beta_1 \ Prison_{it} 
+ \beta_2 \ PoliceShootings_{it} \\
& + \beta_3 \ PoliceSpending_{it} 
+ \beta_4 \ CorrectionsSpending_{it} \\
& + \beta_5 \ Alcohol_{it} 
+ \beta_6 \ log(Pop_{it}) 
+ \delta_t 
+ \varepsilon_{it}
\end{aligned}$$

This model does not aim to measure deterrence effects, but rather documents how crime co-varies with enforcement intensity and social regulation in the short run.

```{r}
ols_property_inst <- lm(
  Data.Rates.Property.All ~ prison_population +
    nb_police_shootings +
    spending_police +
    spending_corrections +
    beer_per_capita_14plus +
    log_pop +
    factor(Year),
  data = panel_short_inst
)

ols_violent_inst <- lm(
  Data.Rates.Violent.All ~ prison_population +
    nb_police_shootings +
    spending_police +
    spending_corrections +
    beer_per_capita_14plus +
    log_pop +
    factor(Year),
  data = panel_short_inst
)

```

These results should therefore be interpreted as descriptive associations rather than causal effects.

#### Robustness: Two-way fixed effects (TWFE) for the economic stress model

As a robustness check, we also estimate a two-way fixed effects version of the economic stress model (state FE + year FE). With only four years, this specification is demanding and is used mainly to assess the robustness of the pooled OLS associations to unobserved state-level heterogeneity.

```{r}
twfe_property_econ <- plm(
  Data.Rates.Property.All ~ log_gdp + unemployment_rate +
    percent_poor + share_pretax_income_p90p100 + log_pop,
  data = panel_short_inst,
  index = c("State","Year"),
  model = "within",
  effect = "twoways"
)
```

#### Results

```{r}
modelsummary(
  list(
    "Property crime" = ols_property_econ,
    "Violent crime"  = ols_violent_econ
  ),
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "log_gdp" = "Log GDP",
    "unemployment_rate" = "Unemployment rate",
    "percent_poor" = "Poverty rate",
    "share_pretax_income_p90p100" = "Inequality (top 10%)",
    "log_pop" = "Log population"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Pooled OLS with year fixed effects. Standard errors in parentheses.",
  output = "kableExtra"
) |>
  kableExtra::kable_styling(latex_options = "HOLD_position")
  
```

```{r}
modelsummary(
  list(
    "Property crime" = ols_property_inst,
    "Violent crime"  = ols_violent_inst
  ),
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "prison_population" = "Prison population",
    "nb_police_shootings" = "Police shootings",
    "spending_police" = "Police spending",
    "spending_corrections" = "Corrections spending",
    "beer_per_capita_14plus" = "Beer consumption",
    "log_pop" = "Log population"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Pooled OLS with year fixed effects. Standard errors in parentheses.",
  output = "kableExtra"
) |>
  kableExtra::kable_styling(latex_options = "HOLD_position")
```

```{r}
modelsummary(
  list(
    "TWFE – Property crime" = twfe_property_econ
  ),
  stars = c('*' = 0.05, '**' = 0.01, '***' = 0.001),
  coef_rename = c(
    "log_gdp" = "Log GDP",
    "unemployment_rate" = "Unemployment rate",
    "percent_poor" = "Poverty rate",
    "share_pretax_income_p90p100" = "Inequality (top 10%)",
    "log_pop" = "Log population"
  ),
  gof_omit = "IC|Log|RMSE|Adj|Std.Errors",
  notes = "Two-way fixed effects (state and year). Short panel: results interpreted cautiously.",
  output = "kableExtra"
) |>
  kableExtra::kable_styling(latex_options = "HOLD_position")
```


The short-run regressions provide limited and fragile explanatory power, reflecting the very short time dimension of the panel. The pooled OLS models explain at most 29–32% of the variation in property crime ($R² ≈ 0.29–0.32$) and around 29% for violent crime, indicating that a large share of cross-state crime differences remains unexplained.

For property crime, poverty and income inequality are the only consistently significant covariates. Poverty is positively associated with property crime ($β ≈ 84$, $p = 0.004$), and the top 10% income share is also significant ($p = 0.015$). GDP, unemployment, and population size are not statistically significant. These results suggest correlation rather than a robust structural relationship.

For violent crime, results are even less stable. Unemployment is significant ($β ≈ 70$, $p = 0.001$), while poverty is only marginally significant ($p ≈ 0.06$) and inequality is not significant. Model fit remains modest ($R² ≈ 0.29$), pointing to weak short-run explanatory content.

Institutional models perform slightly better for property crime ($R² ≈ 0.32$) but very poorly for violent crime ($R² ≈ 0.11$). Police shootings per capita are the only robust institutional correlate ($p < 0.05$), while incarceration and spending variables are not significant, likely reflecting reverse causality and multicollinearity.

The two-way fixed effects model further weakens results ($R² ≈ 0.13$), confirming that short-run within-state variation is insufficient to identify stable relationships. Overall, these findings should be interpreted as descriptive correlations rather than reliable estimates of causal effects.

## Conclusion and limitations

### Limitations

Several limitations should be kept in mind when interpreting the results. 

The long run analysis focuses on 1998–2018, a period of sustained crime decline across U.S. states. The relationships we document may not generalize to periods of rising crime in the United States. Despite the use of fixed effects, the estimated relationships remain associative rather than causal. Key variables such as incarceration, unemployment, and alcohol consumption may be jointly determined with crime. We lack credible instruments or natural experiments to establish causal effects. The positive correlation between prison population and crime, for instance, likely reflects reverse causality rather than failed deterrence. Data constraints exclude social capital, educational quality, and drug markets, potentially biasing estimated coefficients.

As for the short-run analysis, it is constrained by a very limited time dimension. This restricts statistical power and makes highly saturated specifications, such as two-way fixed effects models, imprecise. As a result, short-run regression results should be interpreted as descriptive correlations rather than structural effects. Several institutional variables included in the short-run models—police shootings, public spending, and prison population are likely endogenous responses to crime levels. Their coefficients therefore capture contemporaneous co-movement rather than deterrence or policy effects.

Finally, crime exhibits strong persistence over time, especially for violent crime. Once lagged crime is included, most contemporaneous covariates lose significance, indicating that short-run variations are dominated by inertia. This limits the ability of static models to identify independent short-term drivers of crime.

### Conclusion

This project examines how crime in U.S. states co-evolves with economic and social conditions, and whether these relationships differ between property and violent crime.

The empirical evidence reveals a clear distinction between the two crime types. Property crime is systematically associated with economic conditions, particularly poverty and, to a lesser extent, unemployment. These variables are statistically significant in multiple specifications and the corresponding models explain a substantial share of within-state variation. This pattern is consistent with economic theories of crime, according to which material deprivation increases incentives for financially motivated offences.

In contrast, violent crime shows a much weaker connection to economic variables. GDP, inequality and consumption are generally insignificant, and explanatory power remains limited in static models. Once lagged crime is introduced, model fit increases sharply, with a large and highly significant persistence coefficient, indicating that violent crime is driven primarily by inertia rather than contemporaneous economic conditions.

Institutional variables such as incarceration rates and police activity are positively correlated with crime, but their interpretation is ambiguous and likely reflects policy responses to crime rather than causal deterrence effects.

Hence, the results show that economic and social conditions matter mainly for property crime, while violent crime is characterised by strong persistence and limited sensitivity to short-run economic fluctuations, providing a coherent and robust answer to the research question.


